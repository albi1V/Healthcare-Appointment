<div class="doctor-appointments-page">

  <!-- Page Header -->
  <header class="page-header">
    <div class="title-wrap">
      <h2 class="page-title">My Appointments</h2>
      <p class="subtitle">Today‚Äôs schedule and upcoming visits</p>
    </div>

    <div class="toolbar">
      <!-- Search -->
      <div class="search">
        <i class="ph ph-magnifying-glass" aria-hidden="true"></i>
        <input
          #q
          type="text"
          class="search-input"
          placeholder="Search by patient name, email, or ID‚Ä¶"
          (input)="onSearch(q.value)"
        />
      </div>

      <!-- Refresh -->
      <button class="btn btn-refresh" (click)="refresh()" [disabled]="loading">
        <span class="spinner" *ngIf="loading"></span>
        Refresh
      </button>
    </div>
  </header>

  <!-- Card -->
  <div class="card">
    <div class="card-body">

      <!-- Empty state when nothing today and nothing upcoming -->
      <div
        *ngIf="(todayList?.length || 0) === 0 && (upcomingList?.length || 0) === 0"
        class="empty-state">
        <div class="empty-graphic" aria-hidden="true">üóìÔ∏è</div>
        <h4>No appointments today or upcoming</h4>
        <p class="muted">Try searching or check back later.</p>
      </div>

      <!-- Today Section -->
      <section *ngIf="todayList && todayList.length > 0" class="table-wrap" aria-labelledby="today-title" style="margin-bottom:16px;">
        <h3 id="today-title" class="page-title" style="padding: 12px 14px; margin: 0; font-size: 18px;">
          Today ({{ todayList.length }})
        </h3>
        <table class="appointments-table">
          <thead>
            <tr>
              <th>Appointment ID</th>
              <th class="col-time">Time</th>
              <th>Patient</th>
              <th>Contact</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let appt of todayList; trackBy: trackById">
              <td class="col-id">#{{ appt.id }}</td>
              <td class="col-time">
                {{ (appt.appointmentTime || appt.appointmentDate) | date:'dd-MMM-yyyy hh:mm a' }}
              </td>
              <td class="col-patient">
                <strong>{{ appt.patient?.name || appt.patient?.username || 'Unknown' }}</strong>
              </td>
              <td class="col-contact">
                <span class="muted">{{ appt.patient?.email || '‚Äî' }}</span>
              </td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- Upcoming Section -->
      <section *ngIf="upcomingList && upcomingList.length > 0" class="table-wrap" aria-labelledby="upcoming-title">
        <h3 id="upcoming-title" class="page-title" style="padding: 12px 14px; margin: 0; font-size: 18px;">
          Upcoming ({{ upcomingList.length }})
        </h3>
        <table class="appointments-table">
          <thead>
            <tr>
              <th>Appointment ID</th>
              <th class="col-time">Time</th>
              <th>Patient</th>
              <th>Contact</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let appt of upcomingList; trackBy: trackById">
              <td class="col-id">#{{ appt.id }}</td>
              <td class="col-time">
                {{ (appt.appointmentTime || appt.appointmentDate) | date:'dd-MMM-yyyy hh:mm a' }}
              </td>
              <td class="col-patient">
                <strong>{{ appt.patient?.name || appt.patient?.username || 'Unknown' }}</strong>
              </td>
              <td class="col-contact">
                <span class="muted">{{ appt.patient?.email || '‚Äî' }}</span>
              </td>
            </tr>
          </tbody>
        </table>
      </section>

    </div>
  </div>
</div>








